generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id              String    @id @default(uuid())
  fullName        String
  email           String    @unique
  phone           String
  passwordHash    String
  accountType     String    // donor | patient
  verified        Boolean   @default(false)
  campaign        Campaign? @relation(fields: [campaignId], references: [id])
  campaignId      String?   @unique
  registrationDate DateTime  @default(now())
  createdAt       DateTime  @default(now())
  updatedAt       DateTime  @updatedAt
}

model Hospital {
  id              String                 @id @default(uuid())
  hospitalId      String                 @unique
  hospitalName    String
  address         String
  phone           String
  adminName       String
  adminEmail      String                 @unique
  passwordHash    String
  status          String                 @default("pending")
  verifiedPatients User[]
  services        String?
  registeredDate  DateTime               @default(now())
  verificationRequests VerificationRequest[]
  createdAt       DateTime               @default(now())
  updatedAt       DateTime               @updatedAt
}

model Campaign {
  id              String      @id @default(uuid())
  title           String
  description     String
  goalAmount      Float
  raisedAmount    Float       @default(0)
  patientName     String
  patientAge      Int?
  hospitalName    String
  photo           String?
  patient         User?
  donations       Donation[]
  creationDate    DateTime    @default(now())
  createdAt       DateTime    @default(now())
  updatedAt       DateTime    @updatedAt
}

model Event {
  id              String      @id @default(uuid())
  title           String
  date            DateTime
  location        String
  description     String
  raisedAmount    Float       @default(0)
  donations       Donation[]
  createdAt       DateTime    @default(now())
  updatedAt       DateTime    @updatedAt
}

model Donation {
  id              String      @id @default(uuid())
  amount          Float
  donorName       String      @default("Anonymous")
  paymentMethod   String
  reference       String?     // Paystack ref
  status          String      @default("pending")
  campaign        Campaign?   @relation(fields: [campaignId], references: [id])
  campaignId      String?
  event           Event?      @relation(fields: [eventId], references: [id])
  eventId         String?
  message         String?
  createdAt       DateTime    @default(now())
}

model VerificationRequest {
  id              String      @id @default(uuid())
  patientName     String
  patientEmail    String
  hospital        Hospital    @relation(fields: [hospitalId], references: [id])
  hospitalId      String
  diagnosis       String
  treatmentCost   Float
  status          String      @default("pending")
  rejectionReason String?
  submittedDate   DateTime    @default(now())
  createdAt       DateTime    @default(now())
  updatedAt       DateTime    @updatedAt
}